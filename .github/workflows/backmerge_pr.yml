on:
  push:
    branches: [ master ]

jobs:
    pull-request-master-into-release:
     runs-on: ubuntu-latest
     
     steps:
       - name: checkout all branches 
         uses: actions/checkout@v2

       - name: pull-request (master into release)
         uses: repo-sync/pull-request@v2
         with:
           source_branch: "master"                 
           destination_branch:  "release"                               
           pr_title: "backmerge master into release"             
           pr_body: "This PR is automatically generated by github-actions \n Creator: ${{ env.ACTOR }} \n TIME_STAMP: ${{ env.TIME_STAMP }} \n AUTHOR_EMAIL: ${{ env.AUTHOR_EMAIL }} \n AUTHOR_USERNAME: ${{ env.AUTHOR_USERNAME }} \n HEAD_REF: ${{ env.HEAD_REF }} \n BASE_REF: ${{ env.BASE_REF }} \n COMMIT_MESSAGE: ${{ env.COMMIT_MESSAGE }} \n URL: ${{ env.URL }}" 
           pr_reviewer: "BharatBhushan01"                                         
           pr_assignee: "BharatBhushan01"                  
           pr_label: "Release,auto_pr"                     
           github_token: ${{ secrets.SECRET_TOKEN }}
       
    pull-request-master-into-staging:
     runs-on: ubuntu-latest
     needs: [pull-request-master-into-release]

     steps:
       - name: checkout all branches 
         uses: actions/checkout@v2
      
       - name: pull-request (master into staging)
         uses: repo-sync/pull-request@v2
         with:
           source_branch: "master"                 
           destination_branch:  "staging"                               
           pr_title: "backmerge master into staging" 
           pr_body: "This PR is automatically generated by github-actions \n Creator: ${{ env.ACTOR }} \n TIME_STAMP: ${{ env.TIME_STAMP }} \n AUTHOR_EMAIL: ${{ env.AUTHOR_EMAIL }} \n AUTHOR_USERNAME: ${{ env.AUTHOR_USERNAME }} \n HEAD_REF: ${{ env.HEAD_REF }} \n BASE_REF: ${{ env.BASE_REF }} \n COMMIT_MESSAGE: ${{ env.COMMIT_MESSAGE }} \n URL: ${{ env.URL }}"
           pr_reviewer: "BharatBhushan01"                                         
           pr_assignee: "BharatBhushan01"                 
           pr_label: "Release,auto_pr"
           github_token: ${{ secrets.SECRET_TOKEN }}
          
     
 # Global environment variables
env:
    CONTEXT: ${{ toJson(github) }}
    ACTOR:  ${{ github.actor }}
    HEAD_REF: ${{ github.head_ref }}
    BASE_REF: ${{ github.base_ref }}
    AUTHOR_EMAIL: ${{ github.event.commits[0].author.email }}
    AUTHOR_USERNAME: ${{ github.event.commits[0].author.username }}
    COMMIT_MESSAGE: ${{ github.event.commits[0].message }}
    TIME_STAMP: ${{ github.event.commits[0].timestamp }}
    URL: ${{ github.event.commits[0].url }}
    

    run: |
      echo $CONTEXT
      echo $ACTOR
      echo $HEAD_REF
      echo $BASE_REF
      echo $AUTHOR_EMAIL
      echo $COMMIT_MESSAGE
      echo $TIME_STAMP
      echo $URL
